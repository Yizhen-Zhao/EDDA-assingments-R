knitr::opts_chunk$set(echo = TRUE)
nausea = read.table("nauseatable.txt", header = TRUE)
nausea
#We create a datafeam contains 2 columns: nausea, medicine
#Set patient suffered from nausea as 1, otherwise 0
nausea=c(rep(0,times=100), rep(1,times=52),rep(0, times=32), rep(1, times=35),rep(0, times=48), rep(1, times=37))
medicine=c(rep("Chlorpromazine", times=152),rep("Pentobarbital(100mg)", times=67),rep("Pentobarbital(150mg)", times=85))
newNausea = data.frame(nausea,medicine); newNausea
xtabs(~medicine+nausea, data = newNausea)
#Permutation test
label_medic = factor(newNausea$medicine)
nausdata = data.frame(nausea=as.vector(newNausea$nausea), label_medic)
attach(nausdata)
mystat=function(x) sum(residuals(x)^2)
B=1000
tstar=numeric(B)
for(i in 1:B){
treatstar = sample(label_medic)
tstar[i] = mystat(lm(nausea~treatstar))
}
myt = mystat(lm(newNausea$nausea~newNausea$medicine))
hist(tstar)
myt
pl=sum(tstar<myt)/B
pr=sum(tstar>myt)/B
pl
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.width=8, fig.height=4)
I=3; J=2; N=3
rbind(rep(1:I,each=N*J),rep(1:J,N*I),sample(1:(N*I*J)))
bread = read.table("bread.txt", header = TRUE)
par(mfrow=c(1,2))
boxplot(hours ~ humidity, data = bread)
boxplot(hours ~ environment, data = bread)
bread = read.table("bread.txt", header = TRUE)
bread
par(mfrow=c(1,2))
boxplot(hours ~ humidity, data = bread)
boxplot(hours ~ environment, data = bread)
interaction.plot(bread$environment, bread$humidity, bread$hours,
xlab = "Temperature", ylab = "Hours", trace.label = "Humidity")
bread = read.table("bread.txt", header = TRUE)
par(mfrow=c(1,2))
boxplot(hours ~ humidity, data = bread)
boxplot(hours ~ environment, data = bread)
breadaov=lm(hours~humidity*environment, data = bread);
anova(breadaov)
##summary(breadaov)$coefficients
##summary(breadaov)$coefficients
breadaov=lm(hours~humidity*environment, data = bread);
anova(breadaov)
##summary(breadaov)$coefficients
##summary(breadaov)$coefficients
summary(breadaov)$coefficients
par(mfrow=c(1,2))
qqnorm(residuals(breadaov))
plot(fitted(breadaov),residuals(breadaov))
summary(breadaov)
summary(breadaov)$coefficients
summary(breadaov)
summary(breadaov)$coefficients
B=5;
if1 = sample(1:5)
if2 = sample(6:10)
if3 = sample(11:15)
for (i in 1:B) print(c(if1[i], if2[i], if3[i]))
I=15; B=5; N=1
for (i in 1:B) print(sample(1:(N*I)))
I=3; B=5; N=1
for (i in 1:B) print(sample(1:(N*I)))
I=15; B=5; N=1
for (i in 1:B) print(sample(1:(N*I)))
search = read.table("search.txt", header = TRUE)
par(mfrow=c(1,2))
boxplot(time~skill, data=search)
boxplot(time~interface, data=search)
interaction.plot(search$skill,search$interface, search$time,
xlab = "Skill level", ylab = "Time", trace.label = "Interface")
interaction.plot(search$interface,search$skill, search$time,
xlab = "Interface", ylab = "Time", trace.label = "Skill level")
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.width=8, fig.height=4)
cow = read.table("cow.txt", header = TRUE);
#There are two factors influence the milk production
mm = subset(cow, treatment=="A")["milk"]
sf = subset(cow, treatment=="B")["milk"]
mm1 = as.numeric(unlist(mm))
sf1 = as.numeric(unlist(sf))
par(mfrow=c(1,2))
qqnorm(mm1)
qqnorm(sf1)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.width=8, fig.height=4)
cow = read.table("cow.txt", header = TRUE);
cow
#There are two factors influence the milk production
mm = subset(cow, treatment=="A")["milk"]
sf = subset(cow, treatment=="B")["milk"]
mm1 = as.numeric(unlist(mm))
sf1 = as.numeric(unlist(sf))
par(mfrow=c(1,2))
qqnorm(mm1)
qqnorm(sf1)
cow$id = factor(cow$id)
cow$per = factor(cow$per)
cowanova = lm(milk~id+per+treatment,data = cow)
anova(cowanova); summary(cowanova)
cow$id = factor(cow$id)
cow$per = factor(cow$per)
cowanova = lm(milk~id+per+treatment,data = cow)
anova(cowanova); summary(cowanova)
library(lme4)
cow$order=factor(cow$order)
cowlmer = lmer(milk~treatment+order+per+(1|id), data=cow, REML = FALSE)
summary(cowlmer)
cowlmerTreatment = lmer(milk~order+per+(1|id), data=cow, REML = FALSE)
anova(cowlmerTreatment, cowlmer)
cowlmerOrder = lmer(milk~treatment+per+(1|id), data=cow, REML = FALSE)
anova(cowlmerOrder, cowlmer)
cowlmerPer = lmer(milk~treatment+order+(1|id), data=cow, REML = FALSE)
anova(cowlmerPer, cowlmer)
attach(cow)
t.test(milk[treatment=="A"],milk[treatment=="B"],paired=TRUE)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(fig.width=8, fig.height=4)
I=3;B=5;N=1
for (i in 1:B) print(sample(1:(N*I)))
search = read.table("search.txt", header = TRUE)
search
par(mfrow=c(1,2))
boxplot(time~skill, data=search)
boxplot(time~interface, data=search)
interaction.plot(search$skill,search$interface, search$time,
xlab = "Skill level", ylab = "Time", trace.label = "Interface")
interaction.plot(search$interface,search$skill, search$time,
xlab = "Interface", ylab = "Time", trace.label = "Skill level")
search = read.table("search.txt", header = TRUE)
par(mfrow=c(1,2))
boxplot(time~skill, data=search)
boxplot(time~interface, data=search)
interaction.plot(search$skill,search$interface, search$time,
xlab = "Skill level", ylab = "Time", trace.label = "Interface")
interaction.plot(search$interface,search$skill, search$time,
xlab = "Interface", ylab = "Time", trace.label = "Skill level")
search$skill = factor(search$skill)
search$interface = factor(search$interface)
aovsearch=lm(time~interface+skill, data=search)
anova(aovsearch)
summary(aovsearch)
par(mfrow=c(1,2))
qqnorm(residuals(aovsearch))
plot(fitted(aovsearch),residuals(aovsearch))
friedman.test(search$time,search$interface,search$skill)
aovsearch2=lm(time~interface, data=search)
anova(aovsearch2)
